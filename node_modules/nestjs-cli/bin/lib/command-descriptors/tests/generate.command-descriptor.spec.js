"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const caporal_1 = require("../../../core/program/caporal");
const sinon = require("sinon");
const chai_1 = require("chai");
const generate_command_descriptor_1 = require("../generate.command-descriptor");
const generate_command_handler_1 = require("../../handlers/generate-command.handler");
describe('GenerateCommandDescriptor', () => {
    let sandbox;
    beforeEach(() => {
        sandbox = sinon.sandbox.create();
    });
    afterEach(() => {
        sandbox.restore();
    });
    let command;
    beforeEach(() => {
        const program = new caporal_1.CaporalProgram();
        command = program.command('name', 'description');
    });
    describe('#declare()', () => {
        let aliasStub;
        let argumentStub;
        let optionStub;
        let handlerStub;
        beforeEach(() => {
            aliasStub = sandbox.stub(command, 'alias').callsFake(() => command);
            argumentStub = sandbox.stub(command, 'argument').callsFake(() => command);
            optionStub = sandbox.stub(command, 'option').callsFake(() => command);
            handlerStub = sandbox.stub(command, 'handler').callsFake(() => command);
        });
        beforeEach(() => {
            generate_command_descriptor_1.GenerateCommandDescriptor.declare(command);
        });
        it('should declare the command alias g', () => {
            chai_1.expect(aliasStub.calledWith('g')).to.be.true;
        });
        it('should declare the mandatory asset argument with the right description', () => {
            chai_1.expect(argumentStub.calledWith('<asset>', 'The generated asset type')).to.be.true;
        });
        it('should declare the mandatory name argument with the right description', () => {
            chai_1.expect(argumentStub.calledWith('<name>', 'The generated asset name')).to.be.true;
        });
        it('should call handler() with the GenerateCommandHandler', () => {
            chai_1.expect(handlerStub.calledWith(new generate_command_handler_1.GenerateCommandHandler())).to.be.true;
        });
    });
});
