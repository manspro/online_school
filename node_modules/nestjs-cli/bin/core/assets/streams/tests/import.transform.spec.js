"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const import_transform_1 = require("../import.transform");
const chai_1 = require("chai");
const test_utils_1 = require("./test.utils");
describe('ImportTransform', () => {
    const content = '' +
        'import {Module} from \'@nestjs/common\';\n' +
        '\n' +
        '@Module({})\n' +
        'export class AssetModule {}\n';
    const className = 'AssetService';
    const dirname = './path/to/asset/asset.service';
    let reader;
    let writer;
    beforeEach(() => {
        reader = new test_utils_1.BufferedReadable(Buffer.from(content));
        writer = new test_utils_1.BufferedWritable();
    });
    let transform;
    beforeEach(() => transform = new import_transform_1.ImportTransform(className, dirname));
    it('should add the imported asset', done => {
        const newContent = 'import {Module} from \'@nestjs/common\';\n' +
            `import {${className}} from ${dirname};\n` +
            '\n' +
            '@Module({})\n' +
            'export class AssetModule {}\n';
        reader.on('end', () => {
            chai_1.expect(writer.getBuffer().toString()).to.be.equal(newContent);
            done();
        });
        reader.pipe(transform).pipe(writer);
    });
});
